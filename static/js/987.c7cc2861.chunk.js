"use strict";(self.webpackChunkhomebase=self.webpackChunkhomebase||[]).push([[987],{6987:(e,t,n)=>{n.r(t),n.d(t,{default:()=>T});var r=n(4292),o=n(2991),a=n(5096),s=n(9904),l=n(5043),i=n(1893),c=n(3075),u=n(2186),m=n(9435);const d=(e,t,n)=>{const r=(90-e)*(Math.PI/180),o=(t+180)*(Math.PI/180),a=-n*Math.sin(r)*Math.cos(o),s=n*Math.sin(r)*Math.sin(o),l=n*Math.cos(r);return new m.Pq0(a,l,s)};var h=n(579);const f=e=>{let{flights:t,color:n,radius:r,behavior:o}=e;const[a,s]=(0,l.useState)(o?0:1);(0,l.useEffect)((()=>{if("flicker"===o){let e=0;const t=100,n=1e3,r=setInterval((()=>{e+=t,s(Math.random()<.5?0:1),e>=n&&(clearInterval(r),s(1))}),t);return()=>clearInterval(r)}if("smooth"===o){let e=null;const t=performance.now(),n=1e3,r=o=>{const a=o-t,l=Math.min(a/n,1);s(l),l<1&&(e=requestAnimationFrame(r))};return e=requestAnimationFrame(r),()=>{e&&cancelAnimationFrame(e)}}s(1)}),[o]);const i=(0,l.useMemo)((()=>t.map((e=>((e,t,n,r,o)=>{const a=d(e,t,o),s=d(n,r,o),l=(new m.Pq0).addVectors(a,s).multiplyScalar(.5),i=1.5*a.distanceTo(s);l.setLength(l.length()+i);const c=(new m.Pq0).lerpVectors(a,l,.25),u=(new m.Pq0).lerpVectors(a,l,.75),h=new m.s0K(a,c,u,s);return new m.j6(h,64,.5,8,!1)})(e.start.lat,e.start.lon,e.end.lat,e.end.lon,r)))),[t,r]);return(0,h.jsx)(h.Fragment,{children:i.map(((e,t)=>(0,h.jsx)("mesh",{geometry:e,children:(0,h.jsx)("meshBasicMaterial",{color:n,transparent:!0,opacity:a})},t)))})},p=e=>{let{position:t,color:n="#ffffff",onDone:r}=e;const o=(0,l.useRef)(null),a=(0,l.useRef)(null),s=(0,l.useRef)(null),i=1.3,[u,d]=(0,l.useState)(0),[f,p]=(0,l.useState)(0),[g,y]=(0,l.useState)(1);return(0,l.useEffect)((()=>{if(0===t.lengthSq())return;const e=t.clone().normalize(),n=new m.Pq0(0,0,1),r=(new m.PTz).setFromUnitVectors(n,e);o.current.quaternion.copy(r)}),[t]),(0,c.D)((()=>{d(u+.06*(1-u));const e=f+.06*(1-f);p(e);y(1-e),e>.98&&(null===r||void 0===r||r())})),(0,h.jsxs)("group",{ref:o,position:t,children:[(0,h.jsxs)("mesh",{ref:a,scale:[u*i,u*i,u*i],children:[(0,h.jsx)("circleGeometry",{args:[1,64]}),(0,h.jsx)("meshBasicMaterial",{color:n,transparent:!0,opacity:1})]}),(0,h.jsxs)("mesh",{ref:s,scale:[f*i,f*i,f*i],children:[(0,h.jsx)("ringGeometry",{args:[2.95,3.1,64]}),(0,h.jsx)("meshBasicMaterial",{color:n,transparent:!0,opacity:g,side:m.$EB,depthTest:!0})]})]})};class g extends m.Ipv{constructor(e,t,n){super(),this.baseCurve=void 0,this.minT=void 0,this.maxT=void 0,this.baseCurve=e,this.minT=t,this.maxT=n}getPoint(e,t){const n=this.minT+(this.maxT-this.minT)*e;return this.baseCurve.getPoint(n,t)}}const y=e=>{let{color:t,startLat:n,startLon:r,endLat:o,endLon:a,radius:s,animationDuration:i=2500,onDone:u,onProgressPersist:f=!1}=e;const y=(0,l.useRef)(null),v=(0,l.useRef)(null),[w,x]=(0,l.useState)(!1),[j]=(0,l.useState)((()=>performance.now())),[C,k]=(0,l.useState)(!1),S=(0,l.useMemo)((()=>d(n,r,s)),[n,r,s]),A=(0,l.useMemo)((()=>d(o,a,s)),[o,a,s]),P=(0,l.useMemo)((()=>{const e=(new m.Pq0).addVectors(S,A).multiplyScalar(.5),t=1.5*S.distanceTo(A);e.setLength(e.length()+t);const n=(new m.Pq0).lerpVectors(S,e,.25),r=(new m.Pq0).lerpVectors(S,e,.75);return new m.s0K(S,n,r,A)}),[S,A]),b=(0,l.useMemo)((()=>new m.j6(P,64,.5,8,!1)),[P]);return(0,l.useMemo)((()=>{v.current=b}),[b]),(0,c.D)((()=>{if(w)return;let e=(performance.now()-j)/i;if(e>1&&(e=1),f){const t=v.current.index?v.current.index.count:v.current.attributes.position.count,n=Math.floor(t*e);v.current.setDrawRange(0,n),e>=1&&(v.current.setDrawRange(0,t),C||k(!0),x(!0),null===u||void 0===u||u())}else{if(!y.current)return;let t=0,n=0;e<=.5?(t=e/.5,n=0):(t=1,n=(e-.5)/.5,C||k(!0));const r=n,o=t;if(o<=r)y.current.visible=!1;else{y.current.visible=!0;const e=new g(P,r,o),t=new m.j6(e,64,.5,8,!1);y.current.geometry&&y.current.geometry.dispose(),y.current.geometry=t}e>=1&&(y.current.visible=!1,x(!0),null===u||void 0===u||u())}})),(0,h.jsxs)(h.Fragment,{children:[(0,h.jsxs)("mesh",{ref:y,children:[f?(0,h.jsx)("primitive",{object:b,attach:"geometry"}):null,(0,h.jsx)("meshBasicMaterial",{color:t,transparent:!0,opacity:.9})]}),C&&(0,h.jsx)(p,{position:A,color:"#ffcd53",onDone:()=>k(!1)})]})},v=e=>{let{locationArray:t,sequential:n=!1,color:r,radius:o,animationDuration:a=2500,onProgressPersist:s=!0,onAllArcsDone:i="persist",persistArcBehavior:c}=e;const[u,m]=(0,l.useState)(0),[d,p]=(0,l.useState)(0),[g,v]=(0,l.useState)(Array(t.length).fill(!1)),[w,x]=(0,l.useState)(!1);return(0,l.useEffect)((()=>{if(d===t.length&&t.length>0)switch(i){case"remove":v(Array(t.length).fill(!0)),setTimeout((()=>{v(Array(t.length).fill(!1))}),0);break;case"reset":setTimeout((()=>{m(0),p(0),v(Array(t.length).fill(!1))}),500);break;case"persist":x(!0)}}),[d,t.length,i]),(0,h.jsxs)(h.Fragment,{children:[!w&&t.map(((e,t)=>n&&t>u||g[t]&&!s?null:(0,h.jsx)(y,{color:r,startLat:e.start.lat,startLon:e.start.lon,endLat:e.end.lat,endLon:e.end.lon,radius:o+.1,onProgressPersist:s,animationDuration:a,onDone:()=>{v((e=>{const n=[...e];return n[t]=!0,n})),p((e=>e+1)),n&&t===u&&setTimeout((()=>{m((e=>e+1))}),500)}},t))),w&&(0,h.jsx)(f,{flights:t,color:r,radius:o+.1,behavior:c})]})};var w=n(2555);const x={uniforms:{uColor:{value:new m.Q1f("#00aaff")},uIntensity:{value:1},uPower:{value:2}},vertexShader:"\n    varying vec3 vNormal;\n    void main() {\n      vNormal = normalize(normal);\n      gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n    }\n  ",fragmentShader:"\n    uniform vec3 uColor;\n    uniform float uIntensity;\n    uniform float uPower;\n    varying vec3 vNormal;\n    \n    void main() {\n      // Fresnel-like term: how perpendicular the normal is to the view direction\n      float intensity = pow(1.0 - dot(vNormal, vec3(0.0, 0.0, 1.0)), uPower);\n      gl_FragColor = vec4(uColor, intensity * uIntensity);\n    }\n  "},j=e=>{let{earthRadius:t,color:n,opacity:r}=e;const o=(0,l.useRef)(null);return(0,h.jsxs)("mesh",{ref:o,children:[(0,h.jsx)("sphereGeometry",{args:[1.018*t,80,80]}),(0,h.jsx)("shaderMaterial",{side:m.hsX,transparent:!0,depthWrite:!1,uniforms:(0,w.A)((0,w.A)({},x.uniforms),{},{uColor:{value:new m.Q1f(n)},uIntensity:{value:1.2},uPower:{value:2}}),vertexShader:x.vertexShader,fragmentShader:x.fragmentShader,opacity:r})]})},C=e=>{let{radius:t}=e;const n=(0,l.useRef)(null);return(0,h.jsxs)("mesh",{ref:n,children:[(0,h.jsx)("sphereGeometry",{args:[t,64,64]}),(0,h.jsx)("meshStandardMaterial",{color:"#0b2a57",emissive:"#081c3c",emissiveIntensity:.3,roughness:.45})]})},k=e=>{let{position:t,color:n,markerSize:r}=e;const o=(0,l.useRef)(null),a=(0,l.useMemo)((()=>t.clone().normalize()),[t]);return(0,l.useEffect)((()=>{if(!o.current)return;const e=new m.Pq0(0,0,1),n=(new m.PTz).setFromUnitVectors(e,a);o.current.quaternion.copy(n),o.current.position.copy(t)}),[a,t]),(0,h.jsxs)("group",{ref:o,children:[(0,h.jsxs)("mesh",{children:[(0,h.jsx)("circleGeometry",{args:[r,32]}),(0,h.jsx)("meshBasicMaterial",{color:n,side:m.$EB})]}),(0,h.jsx)(S,{baseRadius:1*r,color:n})]})};function S(e){let{baseRadius:t,color:n}=e;const r=(0,l.useRef)(null);return(0,c.D)(((e,t)=>{if(!r.current)return;r.current.userData.elapsed||(r.current.userData.elapsed=0),r.current.userData.elapsed+=t;let n=r.current.userData.elapsed/2.2;n>1&&(r.current.userData.elapsed=0,n=0);const o=1+1.5*n,a=1-n;r.current.scale.set(o,o,o);r.current.material.opacity=a})),(0,h.jsxs)("mesh",{ref:r,children:[(0,h.jsx)("ringGeometry",{args:[1*t,1.5*t,64]}),(0,h.jsx)("meshBasicMaterial",{color:n,transparent:!0,opacity:1,side:m.$EB})]})}const A=e=>{let{cities:t,radius:n,color:r="#ffcd53",markerSize:o=1.5}=e;const a=(0,l.useMemo)((()=>{const e=new Map;for(const n of t)e.set(n.name,n);return Array.from(e.values())}),[t]);return(0,h.jsx)(h.Fragment,{children:a.map(((e,t)=>{const a=d(e.lat,e.lon,n);return(0,h.jsx)(k,{position:a,color:r,markerSize:o},e.name+t)}))})};const P=e=>{let{jsonUrl:t,pointSize:n,onCountrySelect:r,onLoaded:o,dotColor:a,highlightColor:s="#FFFF00"}=e;const[i,u]=(0,l.useState)([]),d=(0,l.useRef)(null),f=(0,l.useRef)(null),p=(0,l.useRef)(null),g=(0,l.useRef)(!1),y=(0,l.useRef)(null),[v,w,x]=(0,l.useMemo)((()=>{const e=new m.Q1f(a);return[e.r,e.g,e.b]}),[a]),[j,C,k]=(0,l.useMemo)((()=>{const e=new m.Q1f(s);return[e.r,e.g,e.b]}),[s]);(0,l.useEffect)((()=>{(async()=>{try{const e=await fetch(t),n=await e.json();console.log("Loaded landDots.json:",n),u(n),o&&o(!0)}catch(e){console.error("Failed to load landDots.json:",e)}})()}),[t]);const S=(0,l.useMemo)((()=>{if(!i.length)return new Float32Array([]);const e=[];for(const{x:t,y:n,z:r}of i)e.push(t,n,r);return new Float32Array(e)}),[i]),A=(0,l.useMemo)((()=>{if(!i.length)return new Float32Array([]);const e=[];for(let t=0;t<i.length;t++)e.push(v,w,x);return new Float32Array(e)}),[i,v,w,x]),P=(0,l.useRef)(null),b=(0,l.useCallback)((e=>{var t;if(p.current={x:e.clientX,y:e.clientY},g.current=!1,y.current=null,null!==(t=e.intersections)&&void 0!==t&&t.length){var n;const t=e.intersections.sort(((e,t)=>e.distance-t.distance))[0];y.current=null!==(n=t.index)&&void 0!==n?n:null}e.stopPropagation()}),[]),D=(0,l.useCallback)((e=>{if(!p.current)return;const t=e.clientX-p.current.x,n=e.clientY-p.current.y;Math.sqrt(t*t+n*n)>20&&(g.current=!0),e.stopPropagation()}),[]),M=(0,l.useCallback)((e=>{if(!i.length)return void console.warn("No dots loaded yet.");if(0===e.intersections.length)return;const t=e.intersections.sort(((e,t)=>e.distance-t.distance))[0],n=t.index;if(null==n||null===y.current||n!==y.current)return p.current=null,void(y.current=null);const o=t.index;if(null==o||!i[o])return void console.warn("No valid index found for intersection.");const a=i[o];console.log("Clicked dot #".concat(o,". Country = ").concat(a.countryName,", ISO = ").concat(a.isoA3)),r&&r(a.isoA3),f.current&&clearTimeout(f.current),d.current=a.isoA3,f.current=setTimeout((()=>{d.current=null}),2e3),p.current=null,y.current=null,g.current=!1,e.stopPropagation()}),[i,r]);return(0,c.D)((()=>{if(!P.current||!i.length)return;const e=P.current.array;for(let t=0;t<i.length;t++){const n=i[t],r=3*t;d.current===n.isoA3?(e[r+0]=j,e[r+1]=C,e[r+2]=k):(e[r+0]=v,e[r+1]=w,e[r+2]=x)}P.current.needsUpdate=!0})),i.length?(0,h.jsxs)("points",{onPointerDown:b,onPointerMove:D,onPointerUp:M,children:[(0,h.jsxs)("bufferGeometry",{children:[(0,h.jsx)("bufferAttribute",{attach:"attributes-position",args:[S,3],count:S.length/3,itemSize:3}),(0,h.jsx)("bufferAttribute",{ref:P,attach:"attributes-color",args:[A,3],count:A.length/3,itemSize:3})]}),(0,h.jsx)("pointsMaterial",{vertexColors:!0,size:n,sizeAttenuation:!0,transparent:!0,opacity:.8})]}):null},b=e=>{let{radius:t,rotationSpeed:n,rotationCoords:r,arcs:o,atmosphere:a,dots:s,cityMarkers:m,isInteracting:d}=e;const f=(0,l.useRef)(null),p=(0,i.A)("md"),g=(0,i.A)("sm"),y=(0,i.A)("xs");let w=1;w=p?1:g?.8:y?.7:.6;const[x,k]=(0,l.useState)(.55),[S,b]=(0,l.useState)(!1);return(0,c.D)(((e,t)=>{if(!f.current)return;d||(f.current.rotation.y+=n);k((e=>(0,u.Cc)(e,w,2*t)))})),(0,h.jsxs)("group",{rotation:r,visible:S,ref:f,scale:x,children:[(0,h.jsx)(C,{radius:t-1}),!!a&&(0,h.jsx)(j,{earthRadius:t-2,color:a.color,opacity:a.opacity}),!!s&&(0,h.jsx)(P,{jsonUrl:s.jsonUrl,dotColor:s.dotColor,pointSize:s.pointSize,onLoaded:e=>b(e)}),!!m&&(0,h.jsx)(A,{cities:m.cities,radius:m.radius,color:m.color,markerSize:m.markerSize}),!!o&&(0,h.jsx)(v,{animationDuration:o.animationDuration,color:o.color,locationArray:o.locationArray,onAllArcsDone:o.onAllArcsDone,onProgressPersist:o.onProgressPersist,radius:o.radius,sequential:o.sequential,persistArcBehavior:o.persistArcBehavior})]})};var D=n(8892),M=n(1053),N=n(688);const R=e=>{let{bloomStrength:t=.7,bloomRadius:n=.5,bloomThreshold:r=0}=e;const o=(0,l.useRef)(null),{gl:a,scene:s,camera:i,size:u}=(0,c.C)();return(0,l.useEffect)((()=>{const e=new D.s(a);e.setSize(u.width,u.height);const l=new M.A(s,i);e.addPass(l);const c=new N.C(new m.I9Y(u.width,u.height),t,n,r);e.addPass(c),o.current=e}),[a,s,i,u,t,n,r]),(0,c.D)((()=>{var e;null===(e=o.current)||void 0===e||e.render()}),1),null},L=[{start:{lat:40.7128,lon:-74.006,name:"New York City"},end:{lat:32.7767,lon:-96.797,name:"Dallas"}},{start:{lat:32.7767,lon:-96.797,name:"Dallas"},end:{lat:40.7128,lon:-74.006,name:"New York City"}},{start:{lat:40.7128,lon:-74.006,name:"New York City"},end:{lat:37.7749,lon:-122.4194,name:"San Francisco"}},{start:{lat:37.7749,lon:-122.4194,name:"San Francisco"},end:{lat:40.7128,lon:-74.006,name:"New York City"}},{start:{lat:40.7128,lon:-74.006,name:"New York City"},end:{lat:38.2527,lon:-85.7585,name:"Louisville"}},{start:{lat:38.2527,lon:-85.7585,name:"Louisville"},end:{lat:40.7128,lon:-74.006,name:"New York City"}},{start:{lat:40.7128,lon:-74.006,name:"New York City"},end:{lat:47.6062,lon:-122.3321,name:"Seattle"}},{start:{lat:47.6062,lon:-122.3321,name:"Seattle"},end:{lat:40.7128,lon:-74.006,name:"New York City"}},{start:{lat:40.7128,lon:-74.006,name:"New York City"},end:{lat:4.711,lon:-74.0721,name:"Bogota"}},{start:{lat:4.711,lon:-74.0721,name:"Bogota"},end:{lat:4.2702,lon:-73.4772,name:"Cumaral"}},{start:{lat:4.2702,lon:-73.4772,name:"Cumaral"},end:{lat:10.391,lon:-75.4794,name:"Cartagena"}},{start:{lat:10.391,lon:-75.4794,name:"Cartagena"},end:{lat:40.7128,lon:-74.006,name:"New York City"}},{start:{lat:40.7128,lon:-74.006,name:"New York City"},end:{lat:30.3935,lon:-86.4958,name:"Destin"}},{start:{lat:30.3935,lon:-86.4958,name:"Destin"},end:{lat:40.7128,lon:-74.006,name:"New York City"}},{start:{lat:40.7128,lon:-74.006,name:"New York City"},end:{lat:37.3382,lon:-121.8863,name:"San Jose, CA"}},{start:{lat:37.3382,lon:-121.8863,name:"San Jose, CA"},end:{lat:40.7128,lon:-74.006,name:"New York City"}},{start:{lat:40.7128,lon:-74.006,name:"New York City"},end:{lat:36.1627,lon:-86.7816,name:"Nashville"}},{start:{lat:36.1627,lon:-86.7816,name:"Nashville"},end:{lat:38.2527,lon:-85.7585,name:"Louisville"}},{start:{lat:38.2527,lon:-85.7585,name:"Louisville"},end:{lat:40.7128,lon:-74.006,name:"New York City"}},{start:{lat:40.7128,lon:-74.006,name:"New York City"},end:{lat:51.5074,lon:-.1278,name:"London"}},{start:{lat:51.5074,lon:-.1278,name:"London"},end:{lat:47.3769,lon:8.5417,name:"Zurich"}},{start:{lat:47.3769,lon:8.5417,name:"Zurich"},end:{lat:55.6761,lon:12.5683,name:"Copenhagen"}},{start:{lat:55.6761,lon:12.5683,name:"Copenhagen"},end:{lat:46.948,lon:7.4474,name:"Bern"}},{start:{lat:46.948,lon:7.4474,name:"Bern"},end:{lat:40.7128,lon:-74.006,name:"New York City"}},{start:{lat:40.7128,lon:-74.006,name:"New York City"},end:{lat:64.1466,lon:-21.9426,name:"Reykjavik"}},{start:{lat:64.1466,lon:-21.9426,name:"Reykjavik"},end:{lat:40.7128,lon:-74.006,name:"New York City"}},{start:{lat:40.7128,lon:-74.006,name:"New York City"},end:{lat:38.2527,lon:-85.7585,name:"Louisville"}},{start:{lat:38.2527,lon:-85.7585,name:"Louisville"},end:{lat:40.7128,lon:-74.006,name:"New York City"}},{start:{lat:40.7128,lon:-74.006,name:"New York City"},end:{lat:38.2527,lon:-85.7585,name:"Louisville"}},{start:{lat:38.2527,lon:-85.7585,name:"Louisville"},end:{lat:40.7128,lon:-74.006,name:"New York City"}}],Y=150,z=Math.PI/180*23.4,F=()=>{const{theme:e,setTheme:t}=(0,o.D)();(0,l.useEffect)((()=>{"dark"!==e&&t("dark")}),[e,t]);const n=(0,i.A)("sm")?"/landDots-150rad-40k.json":"/landDots-150rad-30k.json",[r,c]=(0,l.useState)(!1),u=(0,l.useRef)(null);return(0,h.jsx)("div",{className:"h-full w-full",children:(0,h.jsxs)(s.Hl,{gl:{alpha:!0},style:{background:"transparent"},camera:{position:[0,140,600],fov:35},onCreated:e=>{e.raycaster.params.Points.threshold=2},children:[(0,h.jsx)(a.N,{enableDamping:!0,minDistance:300,minPolarAngle:.3,maxPolarAngle:Math.PI-.3,enablePan:!1,maxDistance:600,onStart:()=>{u.current&&(clearTimeout(u.current),u.current=null),c(!0)},onEnd:()=>{u.current=setTimeout((()=>{c(!1)}),1e3)}}),(0,h.jsx)("ambientLight",{intensity:1}),(0,h.jsx)("hemisphereLight",{intensity:.2,position:[0,50,0]}),(0,h.jsxs)(l.Suspense,{fallback:null,children:[(0,h.jsx)(b,{isInteracting:r,rotationCoords:[z,-1,0],rotationSpeed:.001,radius:Y,dots:{dotColor:"#00aaff",pointSize:2.5,jsonUrl:n},atmosphere:{color:"#00aaff",opacity:.03,earthRadius:Y},arcs:{locationArray:L,color:"#dd6ff0",radius:Y,animationDuration:700,sequential:!1,onProgressPersist:!0,onAllArcsDone:"persist",persistArcBehavior:void 0},cityMarkers:{cities:L.map((e=>({lat:e.end.lat,lon:e.end.lon,name:e.end.name}))),radius:Y,color:"#dd6ff0",markerSize:1}}),(0,h.jsx)(R,{bloomStrength:1.2,bloomRadius:1,bloomThreshold:.3})]})]})})},T=()=>{const{projectSlug:e}=(0,r.g)();return"earth"===e?(0,h.jsx)(F,{}):(0,h.jsx)("div",{children:"Oops! Project not found."})}},1893:(e,t,n)=>{n.d(t,{A:()=>a});var r=n(5043);const o={xs:320,sm:640,md:768,lg:1024,xl:1280,"2xl":1536},a=e=>{const[t,n]=(0,r.useState)(!1);return(0,r.useEffect)((()=>{function t(){const t=window.innerWidth>=o[e];n((e=>e!==t?t:e))}return window.addEventListener("resize",t),t(),()=>window.removeEventListener("resize",t)}),[e]),t}}}]);
//# sourceMappingURL=987.c7cc2861.chunk.js.map